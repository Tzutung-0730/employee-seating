{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport './Employee.css';\nexport default {\n  name: \"EmployeePage\",\n  data() {\n    return {\n      searchQuery: '',\n      employees: [],\n      // 儲存員工資料\n      newEmployee: {\n        empId: '',\n        name: '',\n        email: '',\n        floorSeatSeq: 0\n      },\n      isEmployeeDialogVisible: false,\n      // 控制員工對話框顯示\n      isEdit: false,\n      // 判斷是否為編輯模式\n      employeeForm: {\n        empId: '',\n        name: '',\n        email: '',\n        floorSeatSeq: 0\n      },\n      // 預設座位為 0（未分配座位）\n      seatingCharts: [] // 儲存所有座位資料，用來查找對應的座位\n    };\n  },\n  computed: {\n    filteredEmployees() {\n      return this.employees.filter(emp => emp.empId.includes(this.searchQuery) || emp.name.includes(this.searchQuery));\n    }\n  },\n  methods: {\n    // 載入員工資料\n    loadEmployees() {\n      this.$apiService.get(this.$employees.getAllEmployees).then(res => {\n        this.employees = res;\n      }).catch(() => {\n        console.error(\"無法載入員工資料\");\n      });\n    },\n    // 載入座位資料\n    loadSeatingCharts() {\n      this.$apiService.get(this.$seatingCharts.getEmployeeSeatAssignments).then(res => {\n        this.seatingCharts = res;\n      }).catch(() => {\n        console.error(\"無法載入座位資料\");\n      });\n    },\n    // 顯示座位資訊\n    getSeatInfo(floorSeatSeq) {\n      if (floorSeatSeq === 0) {\n        return '未分配座位';\n      }\n      const seat = this.seatingCharts.find(s => s.floorSeatSeq === floorSeatSeq);\n      return seat ? `${seat.floorNo}樓: 座位${seat.seatNo}` : '座位資料無法找到';\n    },\n    // 顯示新增員工視窗\n    showAddEmployeeDialog() {\n      this.isEmployeeDialogVisible = true;\n      this.isEdit = false; // 設為新增模式\n      this.employeeForm = {\n        empId: '',\n        name: '',\n        email: '',\n        floorSeatSeq: 0\n      }; // 重置表單，預設未分配座位\n    },\n    // 顯示編輯員工視窗\n    showEditEmployeeDialog(employee) {\n      this.isEmployeeDialogVisible = true;\n      this.isEdit = true; // 設為編輯模式\n      this.employeeForm = {\n        ...employee\n      };\n      console.log(\"編輯員工表單\", this.employeeForm);\n    },\n    // 提交新增或編輯的員工表單\n    submitEmployeeForm() {\n      if (this.isEdit) {\n        // 編輯員工資料\n        const request = {\n          empId: this.employeeForm.empId,\n          name: this.employeeForm.name,\n          email: this.employeeForm.email,\n          floorSeatSeq: this.employeeForm.floorSeatSeq // 要包含 floorSeatSeq\n        };\n        this.$apiService.put(this.$employees.updateEmployee(this.employeeForm.empId), request).then(() => {\n          const index = this.employees.findIndex(emp => emp.empId === this.employeeForm.empId);\n          if (index !== -1) {\n            this.employees[index] = {\n              ...this.employeeForm\n            }; // 更新資料\n          }\n          alert(\"員工資料更新成功！\");\n          this.closeDialog();\n        }).catch(error => {\n          console.error(\"Error updating employee:\", error);\n          alert(\"更新員工資料失敗！\");\n        });\n      } else {\n        // 新增員工資料\n        const request = {\n          empId: this.employeeForm.empId,\n          name: this.employeeForm.name,\n          email: this.employeeForm.email,\n          floorSeatSeq: this.employeeForm.floorSeatSeq // 要包含 floorSeatSeq\n        };\n        this.$apiService.post(this.$employees.createEmployee, request).then(res => {\n          this.employees.push(res); // 新增員工資料\n          alert(\"員工新增成功！\");\n          this.closeDialog();\n        }).catch(error => {\n          console.error(\"Error adding employee:\", error);\n          alert(\"新增員工失敗！\");\n        });\n      }\n    },\n    // 關閉對話框\n    closeDialog() {\n      this.isEmployeeDialogVisible = false;\n      this.employeeForm = {\n        empId: '',\n        name: '',\n        email: '',\n        floorSeatSeq: 0\n      }; // 重置表單\n    },\n    // 刪除員工\n    deleteEmployee(employee) {\n      this.$apiService.delete(this.$employees.deleteEmployee(employee.empId)).then(() => {\n        const index = this.employees.indexOf(employee);\n        if (index !== -1) {\n          this.employees.splice(index, 1); // 從列表中移除\n        }\n        alert(\"員工已刪除！\");\n      }).catch(error => {\n        console.error(\"Error deleting employee:\", error);\n        alert(\"刪除員工失敗！\");\n      });\n    }\n  },\n  created() {\n    this.loadEmployees(); // 頁面加載時調用API來加載員工資料\n    this.loadSeatingCharts(); // 同時載入座位資料\n  }\n};","map":{"version":3,"names":["name","data","searchQuery","employees","newEmployee","empId","email","floorSeatSeq","isEmployeeDialogVisible","isEdit","employeeForm","seatingCharts","computed","filteredEmployees","filter","emp","includes","methods","loadEmployees","$apiService","get","$employees","getAllEmployees","then","res","catch","console","error","loadSeatingCharts","$seatingCharts","getEmployeeSeatAssignments","getSeatInfo","seat","find","s","floorNo","seatNo","showAddEmployeeDialog","showEditEmployeeDialog","employee","log","submitEmployeeForm","request","put","updateEmployee","index","findIndex","alert","closeDialog","post","createEmployee","push","deleteEmployee","delete","indexOf","splice","created"],"sources":["C:\\Users\\tzutung\\employee-seating\\employee-seating-frontend\\src\\views\\Employee\\Employee.vue"],"sourcesContent":["<template>\r\n  <div class=\"employee-container\">\r\n    <h1>員工資料管理</h1>\r\n    <input type=\"text\" v-model=\"searchQuery\" placeholder=\"請輸入員編或姓名\" class=\"search-input\" />\r\n    <button @click=\"showAddEmployeeDialog\" class=\"btn add-btn\">\r\n      <i class=\"pi pi-plus\"></i> 新增員工\r\n    </button>\r\n    <table class=\"employee-table\">\r\n      <thead>\r\n        <tr>\r\n          <th>員編</th>\r\n          <th>姓名</th>\r\n          <th>Email</th>\r\n          <th>座位</th>\r\n          <th>操作</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr v-for=\"employee in filteredEmployees\" :key=\"employee.empId\">\r\n          <td>{{ employee.empId }}</td>\r\n          <td>{{ employee.name }}</td>\r\n          <td>{{ employee.email }}</td>\r\n          <td>\r\n            <button :class=\"['seat-btn', employee.floorSeatSeq === 0 ? 'unassigned' : 'assigned']\">\r\n              {{ getSeatInfo(employee.floorSeatSeq) }}\r\n            </button>\r\n          </td>\r\n          <td>\r\n            <button @click=\"showEditEmployeeDialog(employee)\" class=\"btn edit-btn\">\r\n              <i class=\"pi pi-pencil\"></i> 編輯\r\n            </button>\r\n            <button @click=\"deleteEmployee(employee)\" class=\"btn delete-btn\">\r\n              <i class=\"pi pi-trash\"></i> 刪除\r\n            </button>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n\r\n    <!-- 員工新增/編輯視窗 -->\r\n    <div v-if=\"isEmployeeDialogVisible\" class=\"modal\">\r\n      <div class=\"modal-content\">\r\n        <span class=\"close-btn\" @click=\"closeDialog\">&times;</span>\r\n        <h3>{{ isEdit ? '編輯員工' : '新增員工' }}</h3>\r\n\r\n        <!-- 員編 (不可修改) -->\r\n        <label>員編:</label>\r\n        <input type=\"text\" v-model=\"employeeForm.empId\" :disabled=\"isEdit\" placeholder=\"員編\" />\r\n\r\n        <label>姓名:</label>\r\n        <input type=\"text\" v-model=\"employeeForm.name\" placeholder=\"姓名\" />\r\n\r\n        <label>Email:</label>\r\n        <input type=\"email\" v-model=\"employeeForm.email\" placeholder=\"Email\" />\r\n\r\n        <!-- 座位 (顯示樓層和座位號) -->\r\n        <label>座位:</label>\r\n        <input type=\"text\" :value=\"getSeatInfo(employeeForm.floorSeatSeq)\" disabled />\r\n\r\n        <div class=\"button-group\">\r\n          <button @click=\"submitEmployeeForm\" class=\"btn confirm-btn\">送出</button>\r\n          <button @click=\"closeDialog\" class=\"btn cancel-btn\">取消</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport './Employee.css';\r\n\r\nexport default {\r\n  name: \"EmployeePage\",\r\n  data() {\r\n    return {\r\n      searchQuery: '',\r\n      employees: [],  // 儲存員工資料\r\n      newEmployee: { empId: '', name: '', email: '', floorSeatSeq: 0 },\r\n      isEmployeeDialogVisible: false, // 控制員工對話框顯示\r\n      isEdit: false, // 判斷是否為編輯模式\r\n      employeeForm: { empId: '', name: '', email: '', floorSeatSeq: 0 }, // 預設座位為 0（未分配座位）\r\n      seatingCharts: [] // 儲存所有座位資料，用來查找對應的座位\r\n    };\r\n  },\r\n  computed: {\r\n    filteredEmployees() {\r\n      return this.employees.filter(emp =>\r\n        emp.empId.includes(this.searchQuery) || emp.name.includes(this.searchQuery)\r\n      );\r\n    }\r\n  },\r\n  methods: {\r\n    // 載入員工資料\r\n    loadEmployees() {\r\n      this.$apiService\r\n        .get(this.$employees.getAllEmployees)\r\n        .then((res) => {\r\n          this.employees = res;\r\n        })\r\n        .catch(() => {\r\n          console.error(\"無法載入員工資料\");\r\n        });\r\n    },\r\n\r\n    // 載入座位資料\r\n    loadSeatingCharts() {\r\n      this.$apiService\r\n        .get(this.$seatingCharts.getEmployeeSeatAssignments)\r\n        .then((res) => {\r\n          this.seatingCharts = res;\r\n        })\r\n        .catch(() => {\r\n          console.error(\"無法載入座位資料\");\r\n        });\r\n    },\r\n\r\n    // 顯示座位資訊\r\n    getSeatInfo(floorSeatSeq) {\r\n      if (floorSeatSeq === 0) {\r\n        return '未分配座位';\r\n      }\r\n      const seat = this.seatingCharts.find(s => s.floorSeatSeq === floorSeatSeq);\r\n      return seat ? `${seat.floorNo}樓: 座位${seat.seatNo}` : '座位資料無法找到';\r\n    },\r\n\r\n    // 顯示新增員工視窗\r\n    showAddEmployeeDialog() {\r\n      this.isEmployeeDialogVisible = true;\r\n      this.isEdit = false;  // 設為新增模式\r\n      this.employeeForm = { empId: '', name: '', email: '', floorSeatSeq: 0 };  // 重置表單，預設未分配座位\r\n    },\r\n\r\n    // 顯示編輯員工視窗\r\n    showEditEmployeeDialog(employee) {\r\n      this.isEmployeeDialogVisible = true;\r\n      this.isEdit = true;  // 設為編輯模式\r\n      this.employeeForm = { ...employee };\r\n      console.log(\"編輯員工表單\", this.employeeForm);\r\n    },\r\n\r\n    // 提交新增或編輯的員工表單\r\n    submitEmployeeForm() {\r\n      if (this.isEdit) {\r\n        // 編輯員工資料\r\n        const request = {\r\n          empId: this.employeeForm.empId,\r\n          name: this.employeeForm.name,\r\n          email: this.employeeForm.email,\r\n          floorSeatSeq: this.employeeForm.floorSeatSeq, // 要包含 floorSeatSeq\r\n        };\r\n\r\n        this.$apiService\r\n          .put(this.$employees.updateEmployee(this.employeeForm.empId), request)\r\n          .then(() => {\r\n            const index = this.employees.findIndex(emp => emp.empId === this.employeeForm.empId);\r\n            if (index !== -1) {\r\n              this.employees[index] = { ...this.employeeForm };  // 更新資料\r\n            }\r\n            alert(\"員工資料更新成功！\");\r\n            this.closeDialog();\r\n          })\r\n          .catch((error) => {\r\n            console.error(\"Error updating employee:\", error);\r\n            alert(\"更新員工資料失敗！\");\r\n          });\r\n      } else {\r\n        // 新增員工資料\r\n        const request = {\r\n          empId: this.employeeForm.empId,\r\n          name: this.employeeForm.name,\r\n          email: this.employeeForm.email,\r\n          floorSeatSeq: this.employeeForm.floorSeatSeq, // 要包含 floorSeatSeq\r\n        };\r\n\r\n        this.$apiService\r\n          .post(this.$employees.createEmployee, request)\r\n          .then((res) => {\r\n            this.employees.push(res);  // 新增員工資料\r\n            alert(\"員工新增成功！\");\r\n            this.closeDialog();\r\n          })\r\n          .catch((error) => {\r\n            console.error(\"Error adding employee:\", error);\r\n            alert(\"新增員工失敗！\");\r\n          });\r\n      }\r\n    },\r\n\r\n    // 關閉對話框\r\n    closeDialog() {\r\n      this.isEmployeeDialogVisible = false;\r\n      this.employeeForm = { empId: '', name: '', email: '', floorSeatSeq: 0 };  // 重置表單\r\n    },\r\n\r\n    // 刪除員工\r\n    deleteEmployee(employee) {\r\n      this.$apiService\r\n        .delete(this.$employees.deleteEmployee(employee.empId))\r\n        .then(() => {\r\n          const index = this.employees.indexOf(employee);\r\n          if (index !== -1) {\r\n            this.employees.splice(index, 1);  // 從列表中移除\r\n          }\r\n          alert(\"員工已刪除！\");\r\n        })\r\n        .catch((error) => {\r\n          console.error(\"Error deleting employee:\", error);\r\n          alert(\"刪除員工失敗！\");\r\n        });\r\n    }\r\n  },\r\n  created() {\r\n    this.loadEmployees();  // 頁面加載時調用API來加載員工資料\r\n    this.loadSeatingCharts();  // 同時載入座位資料\r\n  }\r\n};\r\n</script>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}